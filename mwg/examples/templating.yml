# Examples of template expansions for documents. Equivalent to overrides.yml

main:
  seed: 131415161718
  name: main
  wvariables:
    count: 0
    string: test
  nodes:
    - type: drop
    - type: insert_one
      document:
        x: {y: b}
        z: {$randomint: {min: 0, max: 100}}
    - type: insert_one
      document:
        string: {$randomstring: {length: 15}}
    - type: insert_one
      document:
        doc: $date
    - type: insert_one
      document:
        # increment by steps of 2.
        # Reset to 0 when it reaches maximum
        # Reset when it gets to 10
        x: {$increment: {variable: count, increment: 2, minimum: 0, maximum: 10}}
    - type: insert_one
      document:
          x: {$usevar: {variable: count}}
    - type: insert_one
      document:
        x: {$usevar: {variable: string}}
    - type: ForN
      N: 20
      next: check1
      node: insert_choose
    - name: insert_choose
      type: insert_one
      next: Finish
      document:
        {y: {$choose: {choices: [a, b, {z: [1 2]}]}}}
    - name: check1
      type: count
      filter: {}
      assertEquals: 26
    - name: check2
      type: count
      filter: {x.y: b}
      assertEquals: 1
    - name: check3
      type: count
      filter: {x.y: a}
      assertEquals: 0
    - name: check4
      type: count
      filter: {x: test}
      assertEquals: 1
    - type: count
      filter: {x: 0}
      assertEquals: 1
    - type: count
      filter: {x: 2}
      assertEquals: 1
