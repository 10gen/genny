# This workload inserts ~1GB of documents in the first phase, and creates a hashed index on them in the second.

SchemaVersion: 2018-07-01
Owner: "@mongodb/server-execution"

Actors:
- Name: InsertData
  Type: Loader
  Threads: 1
  Phases:
  - Repeat: 1
    Database: &db test
    Threads: 1
    CollectionCount: 1
    DocumentCount: 500000
    BatchSize: 10000
    Document:
      "type": "book"
      "title": "The Red Book"
      "attributes": { "color": "red", "size":" large", "inside": { "bookmark":1, "postitnote":2 }, "outside": { "dustcover": "worn" }}
  - &Nop {Nop: true}

- Name: IndexCollection
  Type: RunCommand
  Threads: 1
  Phases:
  - *Nop
  - Repeat: 1
    Database: *db
    Operation:
      OperationMetricsName: CreateIndexesCmd
      OperationName: RunCommand
      OperationCommand:
        createIndexes: Collection0
        indexes:
        - key: { "attributes.$**": 1 }
          name: wildCardIndex
          