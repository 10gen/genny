# This workload inserts ~1GB of documents in the first 2 phases, and creates 2 types of 2dsphere indexes on them in the next 2.

SchemaVersion: 2018-07-01
Owner: "@mongodb/server-execution"

Actors:
- Name: InsertData
  Type: Loader
  Threads: 1
  Phases:
  - Repeat: 1
    Database: &db test
    Threads: 1
    CollectionCount: 1
    DocumentCount: 500000
    BatchSize: 10000
    Document:
      a: [{^RandomInt: {min: -180, max: 180}}, {^RandomInt: {min: -90, max: 90}}]
      name: {^RandomString: {length: 1000}}
  - Repeat: 1
    Database: &db test
    Threads: 1
    CollectionCount: 1
    DocumentCount: 500000
    BatchSize: 10000
    Document:
      b: { type: "Point", coordinates: [{^RandomInt: {min: -180, max: 180}}, {^RandomInt: {min: -90, max: 90}}] }
      name: {^RandomString: {length: 1000}}
  - &Nop {Nop: true}
  - &Nop {Nop: true}

- Name: IndexCollection
  Type: RunCommand
  Threads: 1
  Phases:
  - *Nop
  - *Nop
  - Repeat: 1
    Database: *db
    Operation:
      OperationMetricsName: CreateCoordinateIndexesCmd
      OperationName: RunCommand
      OperationCommand:
        createIndexes: Collection0
        indexes:
        - key: 
            a: "2dsphere"
            name: 1
          name: 2dsphereIndexCoordinate
  - Repeat: 1
    Database: *db
    Operation:
      OperationMetricsName: CreateGeoJsonIndexesCmd
      OperationName: RunCommand
      OperationCommand:
        createIndexes: Collection0
        indexes:
        - key: 
            b: "2dsphere"
            name: 1
          name: 2dsphereIndexGeoJson
