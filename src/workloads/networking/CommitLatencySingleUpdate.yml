---
# Single threaded updates to measure commit latency for various write concern.

SchemaVersion: 2018-07-01
Owner: "@mongodb/product-perf"

Actors:
  - Name: SingleThreadUpdate
    Type: RunCommand
    Threads: 1
    Database: test
    Phases:
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern: { w: 0 }
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern:  { w: 1 }
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern:  { w: 2 }
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern:  { w: 3 }
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern:  { j: true }
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern:  { w: 2, j: true }
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern:  { w: majority, j: false }
      - Repeat: 500
        Operations:
        - OperationCommand:
            update: accounts
            updates: [ { q: { _id: 1 }, u: { $inc: { n: 1 } } } ]
            writeConcern:  { w: majority, j: true }
