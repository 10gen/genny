SchemaVersion: 2018-07-01

# Demonstrate the BigUpdate actor.

Actors:
  - Name: Loader
    Type: Loader
    Threads: 1
    Database: &DB test
    CollectionCount: &NumCollections 10
    DocumentCount: 1000
    Document:
      x: 0
      y: {$randomint: {min: 0, max: 1000}}
      string: {$randomstring: {length: {$randomint: {min: 5, max: 15}}}}
    Indexes:
      - {y: 1}
    Phases:
      - Repeat: 1
      - Repeat: 0
  - Name: BigUpdate
    Type: BigUpdate
    Threads: 1
    Database: *DB
    CollectionCount: *NumCollections
    Phases:
      - UpdateFilter: {}
        Update: {}
        Repeat: 0
      - UpdateFilter: {y: {$randomint: {min: 0, max: 1000}}}
        Update: {"$inc": {"x": 1}}
        Duration: 1000
